<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>LoginID - FIDO2 demo</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- LoginID -->
    <link href="assets/css/fonts.css" rel="stylesheet">
    <link href="style/style.css" rel="stylesheet">

    <link href="static/favicon.ico" rel="icon" type="image/x-icon"/>
    <link href="static/favicon.ico" rel="shortcut icon" type="image/x-icon"/>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="js/html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script type="module">
        import * as WebSDK from '../js/loginid.web.min.js';
        const dw = new web.default(
            "{base_url}", "{web-sdk-client_id}"
        );
        window.dw = dw;
    </script>

    <script src="script/spa-demo.js"></script>

    <link href="css/prism.css" rel="stylesheet"/>
    <script src="js/prism.js"></script>

</head>
<body onload="checkSession();">
<nav>
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navBar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand loginid-nav" href="#tabOverview" data-toggle="tab">
                <img src="images/logo.svg" alt="LoginID" width="146px"/>
            </a>
        </div>
        <div class="collapse navbar-collapse" id="navBar">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle loginid-nav" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Features <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a class="loginid-nav" href="#tabAuthenticate" data-toggle="tab" onclick="getTabContent('tabs/authenticate.tab.html', 'tabAuthenticate');">Authentication</a></li>
                        <li><a class="loginid-nav" href="#tabManageCreds" data-toggle="tab" onclick="getTabContent('tabs/managecreds.tab.html', 'tabManageCreds');">Manage Authenticators (Devices)</a></li>
                        <li><a class="loginid-nav" href="#tabCreateTx" data-toggle="tab" onclick="getTabContent('tabs/createTrx.tab.html', 'tabCreateTx');">Create Transaction Confirmation</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle loginid-nav" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Additional Devices <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a class="loginid-nav" href="#tabReqAddCred" data-toggle="tab" onclick="getTabContent('tabs/requestauthenticator.tab.html', 'tabReqAddCred');">Request Adding Authenticator</a></li>
                        <li><a class="loginid-nav" href="#tabReqTempCred" data-toggle="tab" onclick="getTabContent('tabs/requesttempaccess.tab.html', 'tabReqTempCred');">Request Temporary Access</a></li>
                        <li><a class="loginid-nav" href="#tabGrantRequest" data-toggle="tab" onclick="getTabContent('tabs/grantRequest.tab.html', 'tabGrantRequest');">Grant Request</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle loginid-nav" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Plugins <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a class="loginid-nav" href="#tabKong" data-toggle="tab" onclick="getTabContent('tabs/kong.tab.html', 'tabKong');">Kong Plugin</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a class="loginid-nav" href="#" onclick="return deleteSession();" data-toggle="tab">Logged in as:<br/><span id="idCurrentUser"></span><br/>(click to logout)</a></li>
            </ul>
        </div>
    </div>
</nav>
<div class="container" id="content">
    <div class="tab-content">
        <div id="tabOverview" class="tab-pane active" role="tabpanel">
            <h2>Tutorial</h2>
            <p>Here is a brief overview of the different features that are found behind each menu:</p>
            <table class="table-condensed table-striped">
                <tr>
                    <th>Feature</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>Authentication</strong></td>
                    <td>This menu allows users to register and login to an application</td>
                </tr>
                <tr>
                    <td><strong>Manage Authenticators</strong></td>
                    <td>This menu provides a user with a simple interface to manage registered authenticators (devices)</td>
                </tr>
                <tr>
                    <td><strong>Create Transaction Confirmation</strong></td>
                    <td>This menu displays the <strong>Transaction Confirmation</strong> which uses a biometric digital signature to create a digital receipt for any given transaction such as a payment authentication.</td>
                </tr>
                <tr>
                    <td><strong>Grant Request</strong></td>
                    <td>This menu allows the user to authorize an authorization code that was generated on a different and potentially non-FIDO2 compliant device</td>
                </tr>
                <tr>
                    <td><strong>Request Adding Authenticator</strong></td>
                    <td>The menu enables a user to <strong>add additional authenticators</strong> (devices) to his account</td>
                </tr>
                <tr>
                    <td><strong>Request Temporary Access</strong></td>
                    <td>The menu enables a user to request <strong>temporary access</strong> to his account from a device that may not be owned by the user or which does not support FIDO2</td>
                </tr>
                <tr>
                    <td><strong>Kong Plugin</strong></td>
                    <td>The menu shows how LoginIDs <strong>plugin for Kong</strong> may be used to protect APIs by requiring a LoginID issued FIDO2 credential</td>
                </tr>
            </table>
            <hr/>
            <p>View the setup of the demo here:
                <button id="btnArchitecture" type="button" data-toggle="collapse"
                        data-target="#idArch" aria-expanded="false" aria-controls="idArch">show/hide
                </button>
            </p>
            <div id="idArch" class="collapse">
                <img src="images/setup.png" alt="Demo-Setup" width="1000px"/>
                <ul>
                    <li>The FrontEnd, BackEnd and Gateway are docker images</li>
                    <li>The cloud services are public and are accessed via the demo</li>
                    <li>The FrontEnd displays the web UI which is accessed via a browser</li>
                    <li>The FrontEnd is configured with a <strong>Web App ClientID</strong> which it uses when
                        registering/authenticating users
                    </li>
                    <li>The BackEnd exposes a simple management API and requires an authenticated user (valid JWT)</li>
                    <li>The BackEnd is configured with a <strong>Backend / API Credential</strong> and is able to generate
                        serviceToken
                        that are required to access LoginID management APIs
                    </li>
                    <li>The Kong Gateway is configured with LoginIDs plugin to accept requests only if a valid LoginID issued JWT is included</li>
                </ul>
            </div>
            <hr/>
            <p>To learn more about LoginID please visit: <a href="https://loginid.io" target="_blank">https://loginid.io</a></p>
            <p>To view the developer documentation start here: <a href="https://docs.loginid.io" target="_blank">Dev @ LoginID</a></p>
            <p>More examples can be found on GitHub: <a href="https://github.com/loginid1" target="_blank">LoginID @ GitHub</a></p>
            <br/>
            <p><strong>Disclaimer: </strong>The hosted - online version of this tutorial is a shared environment and meant for evaluation purposes only!</p>
        </div>
        <div id="tabAuthenticate" class="tab-pane" role="tabpanel" aria-labelledby="tabAuthenticateButton">
            <p>tabAuthenticate</p>
        </div>
        <div id="tabGrantRequest" class="tab-pane" role="tabpanel">
            <p>tabGrantRequest</p>
        </div>
        <div id="tabCreateTx" class="tab-pane" role="tabpanel">
            <p>tabCreateTx</p>
        </div>
        <div id="tabManageCreds" class="tab-pane" role="tabpanel">
            <p>tabManageCreds</p>
        </div>
        <div id="tabReqTempCred" class="tab-pane" role="tabpanel">
            <p>tabReqTempCred</p>
        </div>
        <div id="tabReqAddCred" class="tab-pane" role="tabpanel">
            <p>tabReqAddCred</p>
        </div>
        <div id="tabKong" class="tab-pane" role="tabpanel">
            <p>tabKong</p>
        </div>
    </div>
    <hr/>
    <h3>API Responses</h3>
    <button type="button" onclick="return clearApiResponses();">clear</button>
    <div id="divResponse">Nothing to show</div>
    <hr/>
</div>
</body>
</html>